bundle:
  name: ai_demo_generator_demo_AgneticPortFolioManager
variables:
  project_name:
    description: AI Demo Generator Project
    default: AgneticPortFolioManager
  warehouse_name:
    description: Name of the SQL warehouse to use
    default: Shared Unity Catalog Serverless
  warehouse_id:
    lookup:
      warehouse: ${var.warehouse_name}
  environment:
    description: Deployment environment
    default: dev
  workspace_path:
    description: Workspace path where bundle files will be synced
    default: /Users/saswata.sengupta@databricks.com/AgneticPortFolioManager
workspace:
  file_path: ${var.workspace_path}
sync:
  include:
  - agent_bricks_service.py
  - utils.py
  - generate_data.py
  - transformations.sql
  - dashboard_portfolio_risk_execution_overview.lvdash.json
  - pdf/**
  - deploy_resources.py
  - bricks_conf.json
targets:
  dev:
    default: true
    mode: production
    workspace:
      root_path: ${var.workspace_path}/.bundle/${bundle.name}
resources:
  jobs:
    demo_workflow:
      name: '[DEMOGEN] - ${var.project_name} - Data Generation and Transformation'
      tasks:
      - task_key: generate_data
        spark_python_task:
          python_file: ./generate_data.py
          source: WORKSPACE
        environment_key: default
        max_retries: 1
      - task_key: sql_transformations
        depends_on:
        - task_key: generate_data
        sql_task:
          file:
            path: ./transformations.sql
          warehouse_id: ${var.warehouse_id}
        max_retries: 1
      - task_key: deploy_agent_bricks
        depends_on:
        - task_key: sql_transformations
        spark_python_task:
          python_file: ./deploy_resources.py
          source: WORKSPACE
        environment_key: default
        max_retries: 1
      environments:
      - environment_key: default
        spec:
          client: '3'
          dependencies:
          - faker>=19.0.0
          - holidays>=0.35
          - databricks-sdk>=0.18.0
  schemas:
    demo_schema:
      name: saswata_sengupta_agneticportfoliomanager
      catalog_name: sas_demo
      comment: Schema for AgneticPortFolioManager demo
  volumes:
    raw_data_volume:
      name: raw_data
      catalog_name: sas_demo
      schema_name: saswata_sengupta_agneticportfoliomanager
      volume_type: MANAGED
      comment: Volume for AgneticPortFolioManager raw data and artifacts
  dashboards:
    portfolio_risk_execution_overview:
      display_name: ${var.project_name} - Portfolio Risk and Execution Overview
      file_path: ./dashboard_portfolio_risk_execution_overview.lvdash.json
      warehouse_id: ${var.warehouse_id}
artifacts:
  pdf_files:
    files:
    - source: ./pdf/**/*
